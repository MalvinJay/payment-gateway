webpackJsonp([2],{"2kht":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),o=s.n(a),n=s("Usg1"),i=s("NYxO"),l=s("bOdI"),r=s.n(l),c=(s("Y+wi"),s("PJh5"),{name:"ExportModal",props:["modalVisible"],data:function(){return r()({checkAll:!1,form:{is_batch:!1,contacts:[]},characters:0,messages:0,message:"",fileList:[],loading:!1,column:"all",options:[{name:"Single",value:!1},{name:"File Upload",value:!0}],rules:{payment_types:[{required:!0,message:"Please select at least one option",trigger:"change"}]},inputVisible:!1,inputValue:""},"loading",!1)},watch:{message:function(){this.characters=this.message.length,this.messages=Math.ceil(this.characters/160)}},methods:{close:function(){n.a.$emit("logModal",!1)},onChange:function(e,t){this.files=t;var s=this.$el.querySelector(".upload-demo input[type='file']").files[0];this.$store.dispatch("sendToBucket",s)},handleClose:function(e){this.form.contacts.splice(this.form.contacts.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this.inputValue;e&&this.form.contacts.push(e),this.inputVisible=!1,this.inputValue=""},createLog:function(e){var t=this;this.loading=!0,this.$refs[e].validate(function(e){e?(t.form.is_batch&&(t.form.file_url=t.file),t.form.message=t.message,t.$store.dispatch("createLog",t.form).then(function(e){e.data.success?(t.$message({type:"success",message:"Message Sent"}),t.$store.dispatch("getFoneMessengers",{cache:!1}),t.close()):t.$message({type:"error",message:e.data.response.message}),t.loading=!1}).catch(function(e){t.loading=!1;var s=e.response;t.$message({message:s.data.error,type:"error"})})):(t.loading=!1,t.$message({message:"Please correct the errors",type:"error"}))})}},computed:o()({},Object(i.b)({state:"fileState",file:"file"}),{fileUploading:function(){return"LOADING"===this.state}})}),u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{"custom-class":"export-dialog",title:"New Message",visible:e.modalVisible,width:"35%"},on:{close:e.close}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.fileUploading,expression:"fileUploading"}],staticClass:"flex justify-content-center new-export-bg"},[s("el-form",{ref:"form",staticClass:"transaction-form my-2",staticStyle:{width:"90%"},attrs:{"hide-required-asterisk":"",size:"mini",rules:e.rules,model:e.form,"label-width":"150px"}},[s("el-form-item",{attrs:{label:"Type Of Message"}},[s("el-select",{model:{value:e.form.is_batch,callback:function(t){e.$set(e.form,"is_batch",t)},expression:"form.is_batch"}},e._l(e.options,function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),e.form.is_batch?s("div",[s("el-form-item",{attrs:{label:"Upload CSV File"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:"","on-change":e.onChange,limit:1,"auto-upload":!1,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","file-list":e.fileList}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("Click to upload")])],1)],1)],1):s("div",[s("el-form-item",{attrs:{label:"Title Of Message"}},[s("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"Phone Number(s)"}},[e._l(e.form.contacts,function(t){return s("el-tag",{key:t,attrs:{closable:"","disable-transitions":!1},on:{close:function(s){e.handleClose(t)}}},[e._v("\n                        "+e._s(t)+"\n                        ")])}),e._v(" "),e.inputVisible?s("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"mini"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleInputConfirm(t):null}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):s("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ New Number")])],2),e._v(" "),s("el-form-item",{attrs:{label:"Message"}},[s("el-input",{attrs:{type:"textarea",autosize:""},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),s("p",{staticClass:"cha-info"},[e._v(e._s(e.characters)+" characters "+e._s(e.messages)+" messages")])],1)],1),e._v(" "),s("el-form-item",[s("div",{staticClass:"flex justify-content-end w-100"},[s("el-button",{attrs:{type:"text"},on:{click:e.close}},[e._v("Cancel")]),e._v(" "),s("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){e.createLog("form")}}},[e._v("Create")])],1)])],1)],1)])},staticRenderFns:[]};var p=s("VU/8")(c,u,!1,function(e){s("Jjia")},"data-v-7fbd032a",null).exports,m={name:"TopupAccount",props:["modalVisible"],data:function(){return{checkAll:!1,topupoption:"flopay",form:{currency:"ghs"},options:[{name:"Flopay Wallet",value:"flopay"},{name:"External Wallet",value:"external"}],rules:{amount:[{required:!0,message:"This field is required",trigger:"blur"}]},loading:!1}},methods:{close:function(){n.a.$emit("topupModal",!1)},createLog:function(e){var t=this;this.loading=!0,this.$refs[e].validate(function(e){if(e){var s="",a={};"flopay"===t.topupoption?(s="v1/ova/topup",a=t.form):(s="v1/ova/wallet/topup",a=o()({},t.form,{country_code:"GH",service_code:"cashout",live:!0})),t.$store.dispatch("topupOVA",{url:s,ova:a}).then(function(e){e.data.success?(t.$message({type:"success",message:e.data.response.message}),t.$store.dispatch("getFoneMessengers",{cache:!1}),t.close()):t.$message({type:"error",message:e.data.response.message}),t.loading=!1}).catch(function(e){t.loading=!1;var s=e.response;t.$message({message:s.data.error,type:"error"})})}else t.loading=!1,t.$message({message:"Please correct the errors",type:"error"})})}},computed:o()({},Object(i.b)({providers:"providers"}))},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{"custom-class":"export-dialog",title:"Top-Up EVA",visible:e.modalVisible,width:"35%"},on:{close:e.close}},[s("div",{staticClass:"flex justify-content-center new-export-bg"},[s("el-form",{ref:"form",staticClass:"transaction-form my-2",staticStyle:{width:"90%"},attrs:{"hide-required-asterisk":"",size:"mini",rules:e.rules,model:e.form,"label-width":"150px"}},[s("el-form-item",{attrs:{label:"Topup Type"}},[s("el-select",{staticClass:"w-75",model:{value:e.topupoption,callback:function(t){e.topupoption=t},expression:"topupoption"}},e._l(e.options,function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"Amount",prop:"amount"}},[s("el-input",{staticClass:"w-75",model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[e._v("GHs")])])],1),e._v(" "),"external"===e.topupoption?s("div",[s("el-form-item",{attrs:{label:"Provider"}},[s("el-select",{staticClass:"w-75",model:{value:e.form.provider,callback:function(t){e.$set(e.form,"provider",t)},expression:"form.provider"}},e._l(e.providers,function(e,t){return s("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"Phone",prop:"phone"}},[s("el-input",{staticClass:" w-75",model:{value:e.form.customer_no,callback:function(t){e.$set(e.form,"customer_no",t)},expression:"form.customer_no"}})],1),e._v(" "),"vodafone"===e.form.provider?s("el-form-item",{attrs:{label:"Voucher"}},[s("el-input",{staticClass:" w-75",model:{value:e.form.voucher,callback:function(t){e.$set(e.form,"voucher",t)},expression:"form.voucher"}})],1):e._e()],1):e._e(),e._v(" "),s("el-form-item",[s("div",{staticClass:"flex justify-content-end w-100"},[s("el-button",{attrs:{type:"text"},on:{click:e.close}},[e._v("Cancel")]),e._v(" "),s("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){e.createLog("form")}}},[e._v("Create")])],1)])],1)],1)])},staticRenderFns:[]};var f={name:"FoneMessenger",components:{LogDialog:p,TopupAccount:s("VU/8")(m,d,!1,function(e){s("OWZn")},"data-v-2beeb466",null).exports},data:function(){return{test:!0,columns:[{label:"message id",dataField:"response_id",align:"center"},{label:"delivery status",dataField:"response_message",align:"left"},{label:"recipient",dataField:"recipient_no",align:"left"}],logDialog:!1,topupDialog:!1,styleObject:{fontSize:"12px"}}},created:function(){this.$store.dispatch("getFoneMessengers")},mounted:function(){var e=this;n.a.$emit("sideNavClick","fonemessenger"),n.a.$on("logModal",function(){e.logDialog=!1}),n.a.$on("topupModal",function(){e.topupDialog=!1})},beforeDestroy:function(){var e=this;n.a.$off("logModal",function(){e.logDialog=!1})},methods:{handleCurrentChange:function(e){this.$store.dispatch("getFoneMessengers",{page:e,cache:!1})},clickRow:function(e,t,s){this.$refs.fone.toggleRowExpansion(e)},fetchMessages:function(){this.$store.dispatch("getFoneMessengers")},topUpAccount:function(){},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.$store.dispatch("createTransactions",t.form).then(function(e){t.$message({message:"Payment successful",type:"success"})})})},resetForm:function(e){this.$refs[e].resetFields()}},computed:o()({},Object(i.b)({messages:"messages",state:"messagesState",total:"messagesCount",providers:"providers",pageSize:"pageSize"}),{error:function(){return"ERROR"===this.state&&"LOADING"!==this.state},loading:function(){return"LOADING"===this.state}})},g={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-card",{staticClass:"card-0"},[s("div",{staticClass:"transactions"},[s("div",{staticClass:"trans-div flex justify-content-between"},[s("div",{staticClass:"flex align-items-baseline"},[s("p",{staticClass:"blue-text bold-600 s-16 m-0 p-0"},[e._v("Fone Messenger")])]),e._v(" "),s("div",[s("el-button",{staticClass:"z-depth-button bold-600 s-13 open-sans mini-button",attrs:{type:"text"},on:{click:function(t){e.topupDialog=!0}}},[s("i",{staticClass:"plus icon"}),e._v(" Topup")]),e._v(" "),s("el-button",{staticClass:"z-depth-button bold-600 s-13 open-sans mini-button",attrs:{type:"text"},on:{click:function(t){e.logDialog=!0}}},[s("i",{staticClass:"plus icon"}),e._v(" New")])],1)]),e._v(" "),s("div",[e.error?s("div",{staticClass:"center h-80"},[s("div",{staticClass:"center flex-column"},[s("p",{staticClass:"m-0 p-0"},[e._v("Unable to load this page")]),e._v(" "),s("el-button",{attrs:{icon:"sync icon",type:"text"},on:{click:function(t){return t.preventDefault(),e.fetchMessages(t)}}},[e._v("Retry")])],1)]):s("div",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"fone",attrs:{"empty-text":"No fone messengers to display","row-style":e.styleObject,"row-class-name":"transactions-table-body","header-row-class-name":"transactions-table-header",data:e.messages},on:{"row-click":e.clickRow}},[s("el-table-column",{attrs:{type:"expand",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"pl-15"},[s("p",{staticClass:"blue-text s-13 bold-600"},[e._v("Message: ")]),e._v(" "),s("p",{staticClass:"s-12 gray"},[e._v(e._s(t.row.message))])])]}}])}),e._v(" "),e._l(e.columns,function(e,t){return s("el-table-column",{key:t,attrs:{"show-overflow-tooltip":"",prop:e.dataField,label:e.label}})}),e._v(" "),s("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("div",{staticClass:"flex"},[s("the-tag",{attrs:{status:"failed",title:e.row.post_type}})],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"updated_at",label:"Date",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(e._f("moment")(t.row.updated_at,"Do MMM, YYYY hh:mm A"))+"\n                        ")]}}])}),e._v(" --\x3e\n                ")],2),e._v(" "),s("div",{staticClass:"flex justify-content-between align-items-center px-10"},[s("div",{staticClass:"s-12"},[e._v("\n                        "+e._s(e.messages.length)+" results\n                    ")]),e._v(" "),s("el-pagination",{staticClass:"my-2 flex justify-content-end",attrs:{"page-size":e.pageSize,layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)])]),e._v(" "),s("log-dialog",{attrs:{modalVisible:e.logDialog}}),e._v(" "),s("topup-account",{attrs:{modalVisible:e.topupDialog}})],1)},staticRenderFns:[]};var v=s("VU/8")(f,g,!1,function(e){s("LN8N")},"data-v-216bc217",null);t.default=v.exports},Jjia:function(e,t){},LN8N:function(e,t){},OWZn:function(e,t){}});
//# sourceMappingURL=2.45b46826c822e3648750.js.map