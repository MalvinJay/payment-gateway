webpackJsonp([8],{lMaO:function(e,t){},xk2Q:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),l=a.n(s),i=a("Usg1"),o=a("NYxO"),r=a("2etn"),c=a("Y+wi"),n=a("PJh5"),d=a.n(n),u=(a("Ruan"),{name:"NewJob",data:function(){return{isTest:!0,form:{name:"",scheduled:!0,schedule:"daily",service_code:"cashin",start_date:"",termination_date:"",timezone:"Africa/Accra",country_code:"GH",live:!this.testData,test:this.testData},beneficiaries:"upload",contactData:[],schedule:{},loading:!1,response:{},files:[],days:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],rules:{description:[{required:!0,message:"This field is required",trigger:"blur"},{min:3,message:"Length should be at least 3 letters",trigger:"blur"}],amount:[{required:!0,message:"This field is required",trigger:"blur"}]}}},created:function(){this.$store.dispatch("getContacts")},computed:l()({},Object(o.b)({contacts:"contacts",file:"file",test:"test",state:"fileState"}),{daterange:{get:function(){return[this.form.start_date,this.form.termination_date]},set:function(e){this.form.start_date=d()(e[0]).format("YYYY-MM-DD"),this.form.termination_date=d()(e[1]).format("YYYY-MM-DD")}},testData:function(){return this.test},fileUploading:function(){return"LOADING"===this.state},fileError:function(){return"ERROR"===this.state}}),methods:{cancel:function(){this.$router.push("/payments")},save:function(e){var t=this;this.loading=!0,this.$refs[e].validate(function(e){if(e){"createJob",t.form.upload_details={Bucket:r.c,Key:t.file.key},t.form.batch_details={Bucket:r.c,Key:t.file.key},t.form.test=t.test,t.form.dummy=t.test,t.form.live=!t.test,t.form.frequency_type=t.form.schedule,t.form.debit_day=c.a.createDebitFreq(t.form.schedule,t.schedule),t.form.frequency=c.a.createFreq(t.form.schedule,t.schedule);var a=c.a.createJobQuery(t.form.schedule,t.schedule);t.form.schedule=a,t.$store.dispatch("createJob",t.form).then(function(e){e.data.success?(t.$message({type:"success",message:"Job created"}),t.$store.dispatch("getJobs",{cache:!1}),t.$router.push("/jobs")):t.$message({type:"error",message:e.data.response.message}),t.loading=!1}).catch(function(e){t.loading=!1;var a=e.response;t.$message({message:a.data.error,type:"error"})})}else t.loading=!1,t.$message({message:"Please correct the errors",type:"error"})})},onChange:function(e,t){this.files=t;var a=this.$el.querySelector(".upload-demo input[type='file']").files[0];this.$store.dispatch("sendToBucket",a)}},mounted:function(){i.a.$emit("sideNavClick","jobs")}}),m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.fileUploading,expression:"fileUploading"}],class:[{"test-data":e.isTest},"flex","flex-column","card-0","position-relative"],attrs:{"element-loading-text":"Uploading file..."}},[a("div",{staticClass:"flex justify-content-between align-items-center",attrs:{slot:"header"},slot:"header"},[a("h3",{staticClass:"blue-text bold-500 m-0 pb-5"},[e._v("Create a Job")]),e._v(" "),a("div",{staticClass:"standard-button"},[a("el-button",{staticClass:"z-depth-button bold-600 s-13 open-sans b-0",attrs:{size:"mini"},on:{click:e.cancel}},[e._v("Cancel")]),e._v(" "),a("el-button",{staticClass:"z-depth-button bold-600 s-13 open-sans b-0",attrs:{disabled:e.fileError,loading:e.loading,size:"mini",type:"primary"},on:{click:function(t){e.save("form")}}},[e._v("Save Job")])],1)]),e._v(" "),a("div",{staticClass:"p-20"},[a("el-form",{ref:"form",staticClass:"default-form",attrs:{size:"mini","label-position":"right",rules:e.rules,model:e.form,"label-width":"250px"}},[a("el-form-item",{attrs:{label:"Job name",prop:"description"}},[a("el-input",{staticClass:"w-25",model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Retry Limit"}},[a("el-input",{staticClass:"w-25",model:{value:e.form.retry_limit,callback:function(t){e.$set(e.form,"retry_limit",e._n(t))},expression:"form.retry_limit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Service Code"}},[a("el-select",{model:{value:e.form.service_code,callback:function(t){e.$set(e.form,"service_code",t)},expression:"form.service_code"}},[a("el-option",{attrs:{label:"Payout",value:"cashin"}}),e._v(" "),a("el-option",{attrs:{label:"Payment",value:"cashout"}}),e._v(" "),a("el-option",{attrs:{label:"Direct Payment",value:"direct_payment"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Start to End Date"}},[a("el-date-picker",{attrs:{type:"daterange"},model:{value:e.daterange,callback:function(t){e.daterange=t},expression:"daterange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Mode"}},[a("el-select",{model:{value:e.form.scheduled,callback:function(t){e.$set(e.form,"scheduled",t)},expression:"form.scheduled"}},[a("el-option",{attrs:{label:"Automatic",value:!0}}),e._v(" "),"cashin"===e.form.service_code||"cashout"===e.form.service_code?a("el-option",{attrs:{label:"Manual",value:!1}}):e._e()],1)],1),e._v(" "),e.form.scheduled?a("div",[a("el-form-item",{attrs:{label:"Frequency"}},[a("div",{staticClass:"flex align-items-center h-30"},[a("el-switch",{staticClass:"w-150",attrs:{"active-text":"Daily","active-value":"daily"},model:{value:e.form.schedule,callback:function(t){e.$set(e.form,"schedule",t)},expression:"form.schedule"}}),e._v(" "),a("el-switch",{staticClass:"w-150",attrs:{"active-text":"Weekly","active-value":"weekly"},model:{value:e.form.schedule,callback:function(t){e.$set(e.form,"schedule",t)},expression:"form.schedule"}}),e._v(" "),a("el-switch",{staticClass:"w-150",attrs:{"active-text":"Monthly","active-value":"monthly"},model:{value:e.form.schedule,callback:function(t){e.$set(e.form,"schedule",t)},expression:"form.schedule"}})],1),e._v(" "),a("div",{staticClass:"flex align-items-center h-30 mt-2"},[a("el-switch",{staticClass:"w-150",attrs:{"active-text":"BiMonthly","active-value":"bimonthly"},model:{value:e.form.schedule,callback:function(t){e.$set(e.form,"schedule",t)},expression:"form.schedule"}}),e._v(" "),a("el-switch",{staticClass:"w-150",attrs:{"active-text":"Quarterly","active-value":"quarterly"},model:{value:e.form.schedule,callback:function(t){e.$set(e.form,"schedule",t)},expression:"form.schedule"}}),e._v(" "),a("el-switch",{staticClass:"w-150",attrs:{"active-text":"Yearly","active-value":"yearly"},model:{value:e.form.schedule,callback:function(t){e.$set(e.form,"schedule",t)},expression:"form.schedule"}})],1)]),e._v(" "),a("transition",{attrs:{name:"el-fade-in"}},["daily"===e.form.schedule?a("el-form-item",{attrs:{label:"time of trasactions postings"}},[a("el-time-select",{attrs:{"picker-options":{start:"08:30",step:"00:05",end:"18:30"},placeholder:"Select time"},model:{value:e.schedule.time,callback:function(t){e.$set(e.schedule,"time",t)},expression:"schedule.time"}})],1):"weekly"===e.form.schedule?a("el-form-item",{attrs:{label:"date & time of trasactions postings"}},[a("div",{staticClass:"flex"},[a("el-select",{attrs:{placeholder:"select day"},model:{value:e.schedule.date,callback:function(t){e.$set(e.schedule,"date",t)},expression:"schedule.date"}},e._l(e.days,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1),e._v(" "),a("el-time-select",{attrs:{"picker-options":{start:"08:30",step:"00:15",end:"18:30"},placeholder:"Select time"},model:{value:e.schedule.time,callback:function(t){e.$set(e.schedule,"time",t)},expression:"schedule.time"}})],1)]):a("el-form-item",{attrs:{label:"date & time of trasactions postings"}},[a("div",{staticClass:"flex"},[a("el-date-picker",{attrs:{type:"date",placeholder:"Date","value-format":"yyyy-MM-dd",format:"MMM dd, yyyy","default-value":Date.now()},model:{value:e.schedule.date,callback:function(t){e.$set(e.schedule,"date",t)},expression:"schedule.date"}}),e._v(" "),a("el-time-select",{attrs:{"picker-options":{start:"08:30",step:"00:15",end:"18:30"},placeholder:"Select time"},model:{value:e.schedule.time,callback:function(t){e.$set(e.schedule,"time",t)},expression:"schedule.time"}})],1)])],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"Upload CSV"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"","on-change":e.onChange,"auto-upload":!1,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","file-list":e.form.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("Click to upload")])],1),e._v(" "),e.fileError?a("div",{staticClass:"mt-2"},[a("p",{staticClass:"p-0 m-0"},[e._v("Error in Uploading File")]),e._v(" "),a("el-button",{attrs:{type:"text",loading:e.fileUploading,icon:"sync icon"},on:{click:e.onChange}},[e._v("Retry")])],1):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"Download File Format"}},[a("a",{attrs:{download:"",href:"../../../static/Batch_file_format.csv"}},[e._v("Download file format")])])],1),e._v(" "),a("div",{staticClass:"flex justify-content-end"},[a("p",{staticClass:"s-12"},[e._v("NB: Vodafone numbers are not supported")])])],1)])],1)},staticRenderFns:[]};var f=a("VU/8")(u,m,!1,function(e){a("lMaO")},"data-v-d8d96332",null);t.default=f.exports}});
//# sourceMappingURL=8.d3dd04f0ac6c5a51f92d.js.map